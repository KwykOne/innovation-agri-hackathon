{"ast":null,"code":"import _classCallCheck from \"C:\\\\xampp\\\\htdocs\\\\foodomaa\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\xampp\\\\htdocs\\\\foodomaa\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\xampp\\\\htdocs\\\\foodomaa\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\xampp\\\\htdocs\\\\foodomaa\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\xampp\\\\htdocs\\\\foodomaa\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\foodomaa\\\\src\\\\components\\\\Mobile\\\\FloatCart\\\\index.js\";\nimport React, { Component } from \"react\";\nimport { loadCart, removeProduct } from \"../../../services/cart/actions\";\nimport DelayLink from \"../../helpers/delayLink\";\nimport Ink from \"react-ink\";\nimport { connect } from \"react-redux\";\nimport { formatPrice } from \"../../helpers/formatPrice\";\nimport { updateCart } from \"../../../services/total/actions\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport { removeCoupon } from \"../../../services/coupon/actions\";\n\nvar Cart =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Cart, _Component);\n\n  function Cart() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Cart);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Cart)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      isOpen: false,\n      removeProductFromPreviousRestaurant: false,\n      open: false,\n      product: []\n    };\n\n    _this.openFloatCart = function () {\n      _this.setState({\n        isOpen: true\n      });\n    };\n\n    _this.closeFloatCart = function () {\n      _this.setState({\n        isOpen: false\n      });\n    };\n\n    _this.handlePopup = function () {\n      _this.setState({\n        open: !_this.state.open\n      });\n    };\n\n    _this.addProduct = function (product) {\n      var _this$props = _this.props,\n          cartProducts = _this$props.cartProducts,\n          updateCart = _this$props.updateCart; //get restaurant id and save to localStorage as active restaurant\n\n      localStorage.setItem(\"cleared\", \"false\");\n      var productAlreadyInCart = false;\n      var differentRestaurant = false;\n      var cartUpdateflag = true;\n      cartProducts.forEach(function (cp) {\n        if (cartUpdateflag) {\n          if (product.restaurant_id === cp.restaurant_id) {\n            localStorage.setItem(\"activeRestaurant\", product.restaurant_id);\n          } // first check if the restaurent id matches with items in cart\n          // if restaurant id doesn't match, then remove all products from cart\n          // then continue to add the new product to cart\n\n\n          if (cp.restaurant_id === product.restaurant_id) {\n            // then add the item to cart or increment count\n            if (cp.id === product.id) {\n              //check if product has customizations, and if the customization matches with any\n              if (JSON.stringify(cp.selectedaddons) === JSON.stringify(product.selectedaddons)) {\n                // increment the item quantity by 1\n                cp.quantity += 1;\n                productAlreadyInCart = true;\n                differentRestaurant = false;\n              }\n            }\n          } else {\n            // else if restaurant id doesn't match, then remove all products from cart\n            _this.setState({\n              removeProductFromPreviousRestaurant: true,\n              open: true\n            });\n\n            differentRestaurant = true;\n            cartUpdateflag = false;\n\n            _this.setState({\n              product: product\n            }); // setTimeout(() => {\n            // \tthis.setState({ removeProductFromPreviousRestaurant: false });\n            // }, 4 * 1000);\n            // cartProducts.splice(0, cartProducts.length);\n\n          }\n        }\n      });\n\n      if (!productAlreadyInCart && !differentRestaurant) {\n        localStorage.setItem(\"activeRestaurant\", product.restaurant_id);\n        cartProducts.push(product);\n      }\n\n      if (cartUpdateflag) {\n        updateCart(cartProducts);\n      }\n\n      _this.openFloatCart();\n    };\n\n    _this.removeProduct = function (product) {\n      var _this$props2 = _this.props,\n          cartProducts = _this$props2.cartProducts,\n          updateCart = _this$props2.updateCart;\n      var index = cartProducts.findIndex(function (p) {\n        return p.id === product.id;\n      }); //if product is in the cart then index will be greater than 0\n\n      if (index >= 0) {\n        cartProducts.forEach(function (cp) {\n          if (cp.id === product.id) {\n            if (cp.quantity === 1) {\n              //if quantity is 1 then remove product from cart\n              cartProducts.splice(index, 1);\n            } else {\n              //else decrement the quantity by 1\n              cp.quantity -= product.quantity;\n            }\n          }\n        });\n        updateCart(cartProducts);\n\n        if (cartProducts.length < 1) {\n          _this.closeFloatCart();\n\n          localStorage.removeItem(\"activeRestaurant\");\n        }\n      }\n    };\n\n    _this.getTotalItemsInCart = function () {\n      if (localStorage.getItem(\"countQuantityAsTotalItemsOnCart\") === \"true\") {\n        var total = 0;\n\n        _this.props.cartProducts.forEach(function (item) {\n          total += item.quantity;\n        });\n\n        return total;\n      } else {\n        return _this.props.cartTotal.productQuantity;\n      }\n    };\n\n    _this.clearCart = function () {\n      var _this$props3 = _this.props,\n          cartProducts = _this$props3.cartProducts,\n          updateCart = _this$props3.updateCart,\n          removeCoupon = _this$props3.removeCoupon;\n      cartProducts.splice(0, cartProducts.length);\n\n      _this.closeFloatCart();\n\n      removeCoupon();\n      setTimeout(function () {\n        updateCart(cartProducts);\n      }, 500);\n\n      _this.addProduct(_this.state.product);\n\n      _this.openFloatCart();\n\n      _this.setState({\n        open: !_this.state.open,\n        product: []\n      });\n\n      localStorage.setItem(\"cleared\", \"true\");\n    };\n\n    return _this;\n  }\n\n  _createClass(Cart, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var cartProducts = this.props.cartProducts;\n\n      if (cartProducts.length) {\n        this.setState({\n          isOpen: true\n        });\n      }\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (nextProps.newProduct !== this.props.newProduct) {\n        this.addProduct(nextProps.newProduct);\n      }\n\n      if (nextProps.productToRemove !== this.props.productToRemove) {\n        this.removeProduct(nextProps.productToRemove);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props4 = this.props,\n          cartTotal = _this$props4.cartTotal,\n          cartProducts = _this$props4.cartProducts;\n      var classes = [\"float-cart\"];\n\n      if (!!this.state.isOpen) {\n        classes.push(\"float-cart--open\");\n      }\n\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, this.state.removeProductFromPreviousRestaurant && React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, React.createElement(Dialog, {\n        fullWidth: true,\n        fullScreen: false,\n        open: this.state.open,\n        onClose: this.state.handlePopup,\n        style: {\n          width: \"100%\",\n          margin: \"auto\"\n        },\n        PaperProps: {\n          style: {\n            backgroundColor: \"#fff\",\n            borderRadius: \"4px\"\n          }\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container\",\n        style: {\n          borderRadius: \"5px\",\n          height: \"200px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"px-10 col-12 py-3 d-flex justify-content-between align-items-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"mt-2 mb-0 font-weight-black h4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, localStorage.getItem(\"cartReplaceItemTitle\"))), React.createElement(\"div\", {\n        className: \"px-10 mb-20\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, localStorage.getItem(\"cartReplaceItemSubTitle\")), React.createElement(\"div\", {\n        className: \"d-flex justify-content-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"text-center mr-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"btn clear-cart-btn\",\n        onClick: this.handlePopup,\n        style: {\n          borderColor: localStorage.getItem(\"storeColor\")\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, localStorage.getItem(\"cartReplaceItemActionNo\"))), React.createElement(\"div\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"btn clear-cart-btn text-white\",\n        onClick: this.clearCart,\n        style: {\n          backgroundColor: localStorage.getItem(\"storeColor\"),\n          borderColor: localStorage.getItem(\"storeColor\")\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, localStorage.getItem(\"cartReplaceItemActionYes\")))))))) // <Fade duration={250} bottom>\n      // \t<div className=\"auth-error going-different-restaurant-notify\">\n      // \t\t<div className=\"\">{localStorage.getItem(\"itemsRemovedMsg\")}</div>\n      // \t</div>\n      // </Fade>\n      , React.createElement(\"div\", {\n        className: classes.join(\" \"),\n        style: {\n          backgroundColor: localStorage.getItem(\"cartColorBg\"),\n          color: localStorage.getItem(\"cartColorText\")\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219\n        },\n        __self: this\n      }, cartProducts.length ? React.createElement(DelayLink, {\n        to: \"/cart\",\n        delay: 200,\n        className: \"text-white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }, this.getTotalItemsInCart(), \" \", localStorage.getItem(\"floatCartItemsText\")), React.createElement(\"span\", {\n        className: \"pl-5 pr-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }, \"\\xA0|\\xA0\"), React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232\n        },\n        __self: this\n      }, localStorage.getItem(\"currencySymbolAlign\") === \"left\" && localStorage.getItem(\"currencyFormat\"), formatPrice(cartTotal.totalPrice), localStorage.getItem(\"currencySymbolAlign\") === \"right\" && localStorage.getItem(\"currencyFormat\")), React.createElement(\"span\", {\n        className: \"pull-right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      }, localStorage.getItem(\"floatCartViewCartText\"), \" \", React.createElement(\"i\", {\n        className: \"si si-basket\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      })), React.createElement(Ink, {\n        duration: \"500\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      })) : React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, \"\\xA0\")));\n    }\n  }]);\n\n  return Cart;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    cartProducts: state.cart.products,\n    newProduct: state.cart.productToAdd,\n    productToRemove: state.cart.productToRemove,\n    cartTotal: state.total.data\n  };\n};\n\nexport default connect(mapStateToProps, {\n  loadCart: loadCart,\n  updateCart: updateCart,\n  removeProduct: removeProduct,\n  removeCoupon: removeCoupon\n})(Cart);","map":{"version":3,"sources":["C:\\xampp\\htdocs\\foodomaa\\src\\components\\Mobile\\FloatCart\\index.js"],"names":["React","Component","loadCart","removeProduct","DelayLink","Ink","connect","formatPrice","updateCart","Dialog","removeCoupon","Cart","state","isOpen","removeProductFromPreviousRestaurant","open","product","openFloatCart","setState","closeFloatCart","handlePopup","addProduct","props","cartProducts","localStorage","setItem","productAlreadyInCart","differentRestaurant","cartUpdateflag","forEach","cp","restaurant_id","id","JSON","stringify","selectedaddons","quantity","push","index","findIndex","p","splice","length","removeItem","getTotalItemsInCart","getItem","total","item","cartTotal","productQuantity","clearCart","setTimeout","nextProps","newProduct","productToRemove","classes","width","margin","style","backgroundColor","borderRadius","height","borderColor","join","color","totalPrice","mapStateToProps","cart","products","productToAdd","data"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { loadCart, removeProduct } from \"../../../services/cart/actions\";\r\n\r\nimport DelayLink from \"../../helpers/delayLink\";\r\nimport Ink from \"react-ink\";\r\nimport { connect } from \"react-redux\";\r\nimport { formatPrice } from \"../../helpers/formatPrice\";\r\nimport { updateCart } from \"../../../services/total/actions\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport { removeCoupon } from \"../../../services/coupon/actions\";\r\n\r\nclass Cart extends Component {\r\n\tstate = {\r\n\t\tisOpen: false,\r\n\t\tremoveProductFromPreviousRestaurant: false,\r\n\t\topen: false,\r\n\t\tproduct: [],\r\n\t};\r\n\tcomponentDidMount() {\r\n\t\tconst { cartProducts } = this.props;\r\n\t\tif (cartProducts.length) {\r\n\t\t\tthis.setState({ isOpen: true });\r\n\t\t}\r\n\t}\r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\tif (nextProps.newProduct !== this.props.newProduct) {\r\n\t\t\tthis.addProduct(nextProps.newProduct);\r\n\t\t}\r\n\r\n\t\tif (nextProps.productToRemove !== this.props.productToRemove) {\r\n\t\t\tthis.removeProduct(nextProps.productToRemove);\r\n\t\t}\r\n\t}\r\n\r\n\topenFloatCart = () => {\r\n\t\tthis.setState({ isOpen: true });\r\n\t};\r\n\r\n\tcloseFloatCart = () => {\r\n\t\tthis.setState({ isOpen: false });\r\n\t};\r\n\r\n\thandlePopup = () => {\r\n\t\tthis.setState({ open: !this.state.open });\r\n\t};\r\n\r\n\taddProduct = (product) => {\r\n\t\tconst { cartProducts, updateCart } = this.props;\r\n\t\t//get restaurant id and save to localStorage as active restaurant\r\n\r\n\t\tlocalStorage.setItem(\"cleared\", \"false\");\r\n\t\tlet productAlreadyInCart = false;\r\n\t\tlet differentRestaurant = false;\r\n\t\tlet cartUpdateflag = true;\r\n\t\tcartProducts.forEach((cp) => {\r\n\t\t\tif (cartUpdateflag) {\r\n\t\t\t\tif (product.restaurant_id === cp.restaurant_id) {\r\n\t\t\t\t\tlocalStorage.setItem(\"activeRestaurant\", product.restaurant_id);\r\n\t\t\t\t}\r\n\t\t\t\t// first check if the restaurent id matches with items in cart\r\n\t\t\t\t// if restaurant id doesn't match, then remove all products from cart\r\n\t\t\t\t// then continue to add the new product to cart\r\n\t\t\t\tif (cp.restaurant_id === product.restaurant_id) {\r\n\t\t\t\t\t// then add the item to cart or increment count\r\n\t\t\t\t\tif (cp.id === product.id) {\r\n\t\t\t\t\t\t//check if product has customizations, and if the customization matches with any\r\n\t\t\t\t\t\tif (JSON.stringify(cp.selectedaddons) === JSON.stringify(product.selectedaddons)) {\r\n\t\t\t\t\t\t\t// increment the item quantity by 1\r\n\t\t\t\t\t\t\tcp.quantity += 1;\r\n\t\t\t\t\t\t\tproductAlreadyInCart = true;\r\n\t\t\t\t\t\t\tdifferentRestaurant = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// else if restaurant id doesn't match, then remove all products from cart\r\n\t\t\t\t\tthis.setState({ removeProductFromPreviousRestaurant: true, open: true });\r\n\r\n\t\t\t\t\tdifferentRestaurant = true;\r\n\t\t\t\t\tcartUpdateflag = false;\r\n\r\n\t\t\t\t\tthis.setState({ product: product });\r\n\t\t\t\t\t// setTimeout(() => {\r\n\t\t\t\t\t// \tthis.setState({ removeProductFromPreviousRestaurant: false });\r\n\t\t\t\t\t// }, 4 * 1000);\r\n\r\n\t\t\t\t\t// cartProducts.splice(0, cartProducts.length);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (!productAlreadyInCart && !differentRestaurant) {\r\n\t\t\tlocalStorage.setItem(\"activeRestaurant\", product.restaurant_id);\r\n\t\t\tcartProducts.push(product);\r\n\t\t}\r\n\r\n\t\tif (cartUpdateflag) {\r\n\t\t\tupdateCart(cartProducts);\r\n\t\t}\r\n\t\tthis.openFloatCart();\r\n\t};\r\n\r\n\tremoveProduct = (product) => {\r\n\t\tconst { cartProducts, updateCart } = this.props;\r\n\r\n\t\tconst index = cartProducts.findIndex((p) => p.id === product.id);\r\n\r\n\t\t//if product is in the cart then index will be greater than 0\r\n\t\tif (index >= 0) {\r\n\t\t\tcartProducts.forEach((cp) => {\r\n\t\t\t\tif (cp.id === product.id) {\r\n\t\t\t\t\tif (cp.quantity === 1) {\r\n\t\t\t\t\t\t//if quantity is 1 then remove product from cart\r\n\t\t\t\t\t\tcartProducts.splice(index, 1);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t//else decrement the quantity by 1\r\n\t\t\t\t\t\tcp.quantity -= product.quantity;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tupdateCart(cartProducts);\r\n\t\t\tif (cartProducts.length < 1) {\r\n\t\t\t\tthis.closeFloatCart();\r\n\t\t\t\tlocalStorage.removeItem(\"activeRestaurant\");\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tgetTotalItemsInCart = () => {\r\n\t\tif (localStorage.getItem(\"countQuantityAsTotalItemsOnCart\") === \"true\") {\r\n\t\t\tlet total = 0;\r\n\t\t\tthis.props.cartProducts.forEach((item) => {\r\n\t\t\t\ttotal += item.quantity;\r\n\t\t\t});\r\n\t\t\treturn total;\r\n\t\t} else {\r\n\t\t\treturn this.props.cartTotal.productQuantity;\r\n\t\t}\r\n\t};\r\n\r\n\tclearCart = () => {\r\n\t\tconst { cartProducts, updateCart, removeCoupon } = this.props;\r\n\t\tcartProducts.splice(0, cartProducts.length);\r\n\t\tthis.closeFloatCart();\r\n\t\tremoveCoupon();\r\n\t\tsetTimeout(() => {\r\n\t\t\tupdateCart(cartProducts);\r\n\t\t}, 500);\r\n\t\tthis.addProduct(this.state.product);\r\n\t\tthis.openFloatCart();\r\n\t\tthis.setState({ open: !this.state.open, product: [] });\r\n\t\tlocalStorage.setItem(\"cleared\", \"true\");\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { cartTotal, cartProducts } = this.props;\r\n\r\n\t\tlet classes = [\"float-cart\"];\r\n\r\n\t\tif (!!this.state.isOpen) {\r\n\t\t\tclasses.push(\"float-cart--open\");\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t{this.state.removeProductFromPreviousRestaurant && (\r\n\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t<Dialog\r\n\t\t\t\t\t\t\tfullWidth={true}\r\n\t\t\t\t\t\t\tfullScreen={false}\r\n\t\t\t\t\t\t\topen={this.state.open}\r\n\t\t\t\t\t\t\tonClose={this.state.handlePopup}\r\n\t\t\t\t\t\t\tstyle={{ width: \"100%\", margin: \"auto\" }}\r\n\t\t\t\t\t\t\tPaperProps={{ style: { backgroundColor: \"#fff\", borderRadius: \"4px\" } }}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div className=\"container\" style={{ borderRadius: \"5px\", height: \"200px\" }}>\r\n\t\t\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t\t\t<div className=\"px-10 col-12 py-3 d-flex justify-content-between align-items-center\">\r\n\t\t\t\t\t\t\t\t\t\t<h1 className=\"mt-2 mb-0 font-weight-black h4\">\r\n\t\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"cartReplaceItemTitle\")}\r\n\t\t\t\t\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"px-10 mb-20\">{localStorage.getItem(\"cartReplaceItemSubTitle\")}</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"d-flex justify-content-center\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"text-center mr-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"btn clear-cart-btn\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={this.handlePopup}\r\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ borderColor: localStorage.getItem(\"storeColor\") }}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"cartReplaceItemActionNo\")}\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"text-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"btn clear-cart-btn text-white\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={this.clearCart}\r\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: localStorage.getItem(\"storeColor\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tborderColor: localStorage.getItem(\"storeColor\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"cartReplaceItemActionYes\")}\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Dialog>\r\n\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t// <Fade duration={250} bottom>\r\n\t\t\t\t\t// \t<div className=\"auth-error going-different-restaurant-notify\">\r\n\t\t\t\t\t// \t\t<div className=\"\">{localStorage.getItem(\"itemsRemovedMsg\")}</div>\r\n\t\t\t\t\t// \t</div>\r\n\t\t\t\t\t// </Fade>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName={classes.join(\" \")}\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tbackgroundColor: localStorage.getItem(\"cartColorBg\"),\r\n\t\t\t\t\t\tcolor: localStorage.getItem(\"cartColorText\"),\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{cartProducts.length ? (\r\n\t\t\t\t\t\t<DelayLink to={\"/cart\"} delay={200} className=\"text-white\">\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t{this.getTotalItemsInCart()} {localStorage.getItem(\"floatCartItemsText\")}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<span className=\"pl-5 pr-5\">&nbsp;|&nbsp;</span>\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t{localStorage.getItem(\"currencySymbolAlign\") === \"left\" &&\r\n\t\t\t\t\t\t\t\t\tlocalStorage.getItem(\"currencyFormat\")}\r\n\t\t\t\t\t\t\t\t{formatPrice(cartTotal.totalPrice)}\r\n\t\t\t\t\t\t\t\t{localStorage.getItem(\"currencySymbolAlign\") === \"right\" &&\r\n\t\t\t\t\t\t\t\t\tlocalStorage.getItem(\"currencyFormat\")}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t{/* <span>{`${localStorage.getItem(\"currencyFormat\")} ${formatPrice(cartTotal.totalPrice)}`}</span> */}\r\n\t\t\t\t\t\t\t<span className=\"pull-right\">\r\n\t\t\t\t\t\t\t\t{localStorage.getItem(\"floatCartViewCartText\")} <i className=\"si si-basket\" />\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<Ink duration=\"500\" />\r\n\t\t\t\t\t\t</DelayLink>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<span>&nbsp;</span>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</React.Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n\tcartProducts: state.cart.products,\r\n\tnewProduct: state.cart.productToAdd,\r\n\tproductToRemove: state.cart.productToRemove,\r\n\tcartTotal: state.total.data,\r\n});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\t{ loadCart, updateCart, removeProduct, removeCoupon }\r\n)(Cart);\r\n"]},"metadata":{},"sourceType":"module"}