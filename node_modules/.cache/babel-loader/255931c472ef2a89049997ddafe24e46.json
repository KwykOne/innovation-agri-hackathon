{"ast":null,"code":"import _classCallCheck from \"C:\\\\xampp\\\\htdocs\\\\foodomaa\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\xampp\\\\htdocs\\\\foodomaa\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\xampp\\\\htdocs\\\\foodomaa\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\xampp\\\\htdocs\\\\foodomaa\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\xampp\\\\htdocs\\\\foodomaa\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\foodomaa\\\\src\\\\components\\\\Mobile\\\\Cart\\\\Coupon\\\\index.js\";\nimport React, { Component } from \"react\";\nimport Ink from \"react-ink\";\nimport { applyCoupon } from \"../../../../services/coupon/actions\";\nimport { connect } from \"react-redux\";\n\nvar Coupon =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Coupon, _Component);\n\n  function Coupon() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Coupon);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Coupon)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      inputCoupon: \"\",\n      couponFailed: false,\n      couponFailedType: \"\",\n      couponSubtotalMessage: \"\"\n    };\n\n    _this.handleInput = function (event) {\n      _this.setState({\n        inputCoupon: event.target.value\n      });\n    };\n\n    _this.handleSubmit = function (event) {\n      event.preventDefault();\n      var user = _this.props.user;\n      var token = user.success ? _this.props.user.data.auth_token : null;\n\n      _this.props.applyCoupon(token, _this.state.inputCoupon, _this.props.restaurant_info.id, _this.props.subtotal);\n    };\n\n    return _this;\n  }\n\n  _createClass(Coupon, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      // automatically apply coupon if already exists in localstorage\n      if (localStorage.getItem(\"appliedCoupon\")) {\n        this.setState({\n          inputCoupon: localStorage.getItem(\"appliedCoupon\")\n        }, function () {\n          _this2.refs.couponInput.defaultValue = localStorage.getItem(\"appliedCoupon\");\n          var user = _this2.props.user;\n          var token = user.success ? _this2.props.user.data.auth_token : null;\n\n          _this2.props.applyCoupon(token, localStorage.getItem(\"appliedCoupon\"), _this2.props.restaurant_info.id, _this2.props.subtotal);\n        });\n      }\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var coupon = this.props.coupon; //check if props changed after calling the server\n\n      if (coupon !== nextProps.coupon) {\n        //if nextProps.coupon is successful then\n        if (nextProps.coupon.success) {\n          console.log(\"SUCCESS COUPON\");\n          localStorage.setItem(\"appliedCoupon\", nextProps.coupon.code);\n          this.setState({\n            couponFailed: false\n          });\n        } else {\n          console.log(\"COUPON Removed\"); // coupon is invalid\n\n          console.log(\"FAILED COUPON\");\n          localStorage.removeItem(\"appliedCoupon\");\n          this.setState({\n            couponFailed: !nextProps.coupon.hideMessage,\n            couponFailedType: nextProps.coupon.type,\n            couponSubtotalMessage: nextProps.coupon.message\n          });\n        }\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {// this.props.coupon.code = undefined;\n      // localStorage.removeItem(\"appliedCoupon\");\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          coupon = _this$props.coupon,\n          user = _this$props.user;\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"input-group px-15 pb-15\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        className: \"coupon-form \".concat(!user.success && \"coupon-block-not-loggedin\"),\n        onSubmit: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"input-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"input-group-prepend\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"btn apply-coupon-btn\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"si si-tag\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }))), React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control apply-coupon-input\",\n        placeholder: localStorage.getItem(\"cartCouponText\"),\n        onChange: this.handleInput,\n        style: {\n          color: localStorage.getItem(\"storeColor\")\n        },\n        spellCheck: \"false\",\n        ref: \"couponInput\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"input-group-append\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn apply-coupon-btn\",\n        onClick: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        style: {\n          backgroundColor: localStorage.getItem(\"cartColorBg\"),\n          color: localStorage.getItem(\"cartColorText\")\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, localStorage.getItem(\"applyCouponButtonText\")), React.createElement(Ink, {\n        duration: \"500\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }))))), React.createElement(\"div\", {\n        className: \"coupon-status\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, coupon.code && React.createElement(\"div\", {\n        className: \"coupon-success pt-10 pb-10\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, localStorage.getItem(\"showCouponDescriptionOnSuccess\") === \"true\" ? React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, coupon.description) : React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, '\"' + coupon.code + '\"', \" \", localStorage.getItem(\"cartApplyCoupon\"), \" \", coupon.discount_type === \"PERCENTAGE\" ? coupon.discount + \"%\" : React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, localStorage.getItem(\"currencySymbolAlign\") === \"left\" && localStorage.getItem(\"currencyFormat\") + coupon.discount, localStorage.getItem(\"currencySymbolAlign\") === \"right\" && coupon.discount + localStorage.getItem(\"currencyFormat\"), \" \", localStorage.getItem(\"cartCouponOffText\")))), this.state.couponFailed && (this.state.couponFailedType === \"MINSUBTOTAL\" ? React.createElement(\"div\", {\n        className: \"coupon-fail pt-10 pb-10\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, this.state.couponSubtotalMessage) : React.createElement(\"div\", {\n        className: \"coupon-fail pt-10 pb-10\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, localStorage.getItem(\"cartInvalidCoupon\"))), !user.success && React.createElement(\"div\", {\n        className: \"coupon-not-loggedin-message pt-10 pb-10\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"si si-info mr-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }), localStorage.getItem(\"couponNotLoggedin\")))));\n    }\n  }]);\n\n  return Coupon;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    coupon: state.coupon.coupon,\n    restaurant_info: state.items.restaurant_info,\n    user: state.user.user\n  };\n};\n\nexport default connect(mapStateToProps, {\n  applyCoupon: applyCoupon\n})(Coupon);","map":{"version":3,"sources":["C:\\xampp\\htdocs\\foodomaa\\src\\components\\Mobile\\Cart\\Coupon\\index.js"],"names":["React","Component","Ink","applyCoupon","connect","Coupon","state","inputCoupon","couponFailed","couponFailedType","couponSubtotalMessage","handleInput","event","setState","target","value","handleSubmit","preventDefault","user","props","token","success","data","auth_token","restaurant_info","id","subtotal","localStorage","getItem","refs","couponInput","defaultValue","nextProps","coupon","console","log","setItem","code","removeItem","hideMessage","type","message","color","backgroundColor","description","discount_type","discount","mapStateToProps","items"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\n\r\nimport Ink from \"react-ink\";\r\nimport { applyCoupon } from \"../../../../services/coupon/actions\";\r\nimport { connect } from \"react-redux\";\r\n\r\nclass Coupon extends Component {\r\n\tstate = {\r\n\t\tinputCoupon: \"\",\r\n\t\tcouponFailed: false,\r\n\t\tcouponFailedType: \"\",\r\n\t\tcouponSubtotalMessage: \"\",\r\n\t};\r\n\r\n\tcomponentDidMount() {\r\n\t\t// automatically apply coupon if already exists in localstorage\r\n\t\tif (localStorage.getItem(\"appliedCoupon\")) {\r\n\t\t\tthis.setState({ inputCoupon: localStorage.getItem(\"appliedCoupon\") }, () => {\r\n\t\t\t\tthis.refs.couponInput.defaultValue = localStorage.getItem(\"appliedCoupon\");\r\n\t\t\t\tconst { user } = this.props;\r\n\t\t\t\tconst token = user.success ? this.props.user.data.auth_token : null;\r\n\t\t\t\tthis.props.applyCoupon(\r\n\t\t\t\t\ttoken,\r\n\t\t\t\t\tlocalStorage.getItem(\"appliedCoupon\"),\r\n\t\t\t\t\tthis.props.restaurant_info.id,\r\n\t\t\t\t\tthis.props.subtotal\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\tconst { coupon } = this.props;\r\n\t\t//check if props changed after calling the server\r\n\t\tif (coupon !== nextProps.coupon) {\r\n\t\t\t//if nextProps.coupon is successful then\r\n\t\t\tif (nextProps.coupon.success) {\r\n\t\t\t\tconsole.log(\"SUCCESS COUPON\");\r\n\t\t\t\tlocalStorage.setItem(\"appliedCoupon\", nextProps.coupon.code);\r\n\t\t\t\tthis.setState({ couponFailed: false });\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log(\"COUPON Removed\");\r\n\t\t\t\t// coupon is invalid\r\n\t\t\t\tconsole.log(\"FAILED COUPON\");\r\n\t\t\t\tlocalStorage.removeItem(\"appliedCoupon\");\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tcouponFailed: !nextProps.coupon.hideMessage,\r\n\t\t\t\t\tcouponFailedType: nextProps.coupon.type,\r\n\t\t\t\t\tcouponSubtotalMessage: nextProps.coupon.message,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\thandleInput = (event) => {\r\n\t\tthis.setState({ inputCoupon: event.target.value });\r\n\t};\r\n\r\n\thandleSubmit = (event) => {\r\n\t\tevent.preventDefault();\r\n\t\tconst { user } = this.props;\r\n\t\tconst token = user.success ? this.props.user.data.auth_token : null;\r\n\t\tthis.props.applyCoupon(token, this.state.inputCoupon, this.props.restaurant_info.id, this.props.subtotal);\r\n\t};\r\n\r\n\tcomponentWillUnmount() {\r\n\t\t// this.props.coupon.code = undefined;\r\n\t\t// localStorage.removeItem(\"appliedCoupon\");\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { coupon, user } = this.props;\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<div className=\"input-group px-15 pb-15\">\r\n\t\t\t\t\t<form\r\n\t\t\t\t\t\tclassName={`coupon-form ${!user.success && \"coupon-block-not-loggedin\"}`}\r\n\t\t\t\t\t\tonSubmit={this.handleSubmit}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"input-group\">\r\n\t\t\t\t\t\t\t<div className=\"input-group-prepend\">\r\n\t\t\t\t\t\t\t\t<button className=\"btn apply-coupon-btn\">\r\n\t\t\t\t\t\t\t\t\t<i className=\"si si-tag\" />\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tclassName=\"form-control apply-coupon-input\"\r\n\t\t\t\t\t\t\t\tplaceholder={localStorage.getItem(\"cartCouponText\")}\r\n\t\t\t\t\t\t\t\tonChange={this.handleInput}\r\n\t\t\t\t\t\t\t\tstyle={{ color: localStorage.getItem(\"storeColor\") }}\r\n\t\t\t\t\t\t\t\tspellCheck=\"false\"\r\n\t\t\t\t\t\t\t\tref=\"couponInput\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<div className=\"input-group-append\">\r\n\t\t\t\t\t\t\t\t<button type=\"submit\" className=\"btn apply-coupon-btn\" onClick={this.handleSubmit}>\r\n\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: localStorage.getItem(\"cartColorBg\"),\r\n\t\t\t\t\t\t\t\t\t\t\tcolor: localStorage.getItem(\"cartColorText\"),\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"applyCouponButtonText\")}\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t<Ink duration=\"500\" />\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t\t<div className=\"coupon-status\">\r\n\t\t\t\t\t\t{coupon.code && (\r\n\t\t\t\t\t\t\t<div className=\"coupon-success pt-10 pb-10\">\r\n\t\t\t\t\t\t\t\t{localStorage.getItem(\"showCouponDescriptionOnSuccess\") === \"true\" ? (\r\n\t\t\t\t\t\t\t\t\t<React.Fragment>{coupon.description}</React.Fragment>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t\t\t\t{'\"' + coupon.code + '\"'} {localStorage.getItem(\"cartApplyCoupon\")}{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t{coupon.discount_type === \"PERCENTAGE\" ? (\r\n\t\t\t\t\t\t\t\t\t\t\tcoupon.discount + \"%\"\r\n\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"currencySymbolAlign\") === \"left\" &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlocalStorage.getItem(\"currencyFormat\") + coupon.discount}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"currencySymbolAlign\") === \"right\" &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcoupon.discount + localStorage.getItem(\"currencyFormat\")}{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"cartCouponOffText\")}\r\n\t\t\t\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t{/* Coupon is not applied, then coupon state is true */}\r\n\t\t\t\t\t\t{this.state.couponFailed &&\r\n\t\t\t\t\t\t\t(this.state.couponFailedType === \"MINSUBTOTAL\" ? (\r\n\t\t\t\t\t\t\t\t<div className=\"coupon-fail pt-10 pb-10\">{this.state.couponSubtotalMessage}</div>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<div className=\"coupon-fail pt-10 pb-10\">\r\n\t\t\t\t\t\t\t\t\t{localStorage.getItem(\"cartInvalidCoupon\")}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t{!user.success && (\r\n\t\t\t\t\t\t\t<div className=\"coupon-not-loggedin-message pt-10 pb-10\">\r\n\t\t\t\t\t\t\t\t<i className=\"si si-info mr-2\" />\r\n\t\t\t\t\t\t\t\t{localStorage.getItem(\"couponNotLoggedin\")}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</React.Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n\tcoupon: state.coupon.coupon,\r\n\trestaurant_info: state.items.restaurant_info,\r\n\tuser: state.user.user,\r\n});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\t{ applyCoupon }\r\n)(Coupon);\r\n"]},"metadata":{},"sourceType":"module"}